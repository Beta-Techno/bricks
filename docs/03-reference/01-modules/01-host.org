#+TITLE: Host Module Reference
#+AUTHOR: Your Name
#+DATE: 2024

* Host Module

The host module manages the initial configuration of a Proxmox host, including user management, security settings, and basic network configuration.

* Features

- Initial host configuration
- User and API token management
- Security hardening
- Basic network setup (SSH)
- Local storage configuration

* Usage

#+BEGIN_SRC hcl
module "proxmox_host" {
  source = "../../../modules/proxmox-host"
  
  ip_address         = var.ip_address
  root_password      = var.root_password
  automation_password = var.automation_password
  network_ports      = var.network_ports
  ssh_port          = var.ssh_port
  storage_path      = var.storage_path
}
#+END_SRC

* Inputs

| Name | Description | Type | Default | Required |
|------|-------------|------|---------|:--------:|
| ip_address | The IP address of the Proxmox host | string | n/a | yes |
| root_password | The root password for the Proxmox host | string | n/a | yes |
| automation_password | The password for the automation user | string | n/a | yes |
| network_ports | List of network ports to configure | list(string) | ["eth0"] | no |
| ssh_port | The SSH port to use | number | 22 | no |
| storage_path | The path to the storage device for local-lvm | string | "/dev/sda3" | no |

* Outputs

| Name | Description |
|------|-------------|
| api_url | The API URL for the Proxmox host |
| automation_user | The automation user details for API access |

* Example

#+BEGIN_SRC hcl
# Configure the Proxmox provider
provider "proxmox" {
  pm_api_url      = "https://${var.ip_address}:8006/api2/json"
  pm_user         = "root@pam"
  pm_password     = var.root_password
  pm_tls_insecure = true  # For development only
}

# Configure the host
module "proxmox_host" {
  source = "../../../modules/proxmox-host"
  
  ip_address         = "10.0.0.10"
  root_password      = "your-root-password"
  automation_password = "your-automation-password"
  network_ports      = ["eth0"]
  ssh_port          = 22
  storage_path      = "/dev/sda3"
}
#+END_SRC

* Notes

- The root password must be at least 8 characters long
- The automation password must be at least 8 characters long
- The IP address must be a valid IPv4 address
- The storage path must be a valid device path (e.g., /dev/sda3)
- Network port names must be alphanumeric
- The SSH port must be between 1 and 65535

* See Also
- [[file:../../architecture/overview.org][Architecture Overview]]
- [[file:../environments/first-node.org][First Node Environment]]
- [[file:../../best-practices/security.org][Security Best Practices]] 